---
title: 【C++】浅谈垃圾回收：垃圾回收的图论模型
comments: true
mathjax: true
date: 2019-10-04 23:05:00
tags:
 - C++
 - 垃圾回收
 - 图论
 - 标记算法
 - 智能指针
categories: C++
---

垃圾回收，可以说是现代语言一个必需的标准。自从`Lisp`问世以来，`GC`就走进了人们的视野。可惜的是，`C++`依然没有标准的`GC`实现，这使得基于`C++`的项目的开发效率大打折扣。并且人工管理内存极容易出错，而使用`RAII`又在一定程度上增加了对对象结构层次进行管理的难度。
所以本系列文章就是为了解决这个难题，为`C++`造一个`GC`。
<!-- more -->
# 主流的内存管理算法

一般来讲，`GC`算法分为这两大类：

- **引用计数类**算法
- **标记类**算法

其中，`引用计数`算法是大家最熟悉的`GC`算法，`C++`的`std::shared_ptr<T>`就是一个典型的例子。以及在`Python`中，`引用计数`也有被用在部分的垃圾回收中。`引用计数`算法的缺点就是无法解决循环引用的问题。比如下面这个例子：



对象A和对象B互相引用，它们的引用计数都为1，但实际上，它们都不可能被引用到。这就造成了内存泄漏。

我们再看标记类算法。标记类算法是以标记对象为核心，每次进行一次遍历，能够遍历到的对象都打上标记，最后删除没有标记的对象。

